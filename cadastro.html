<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Cadastro - Amigo Secreto</title>
  <link rel="stylesheet" href="style2.css">
</head>
<body>
  <div class="container">
    <h1>Cadastro</h1>
    <div class="form-row">
      <label class="label">Nome</label>
      <input id="nome" type="text" placeholder="Digite seu nome">
      <label class="label">Senha</label>
      <input id="senha" type="password" placeholder="Crie uma senha">
      <label class="label">Escolha seu avatar</label>
      <div class="avatar-grid" id="avatarGrid"></div>
      <button id="btnCadastrar">Cadastrar</button>
    </div>
  </div>

  <script type="module">
    import { db } from "./firebase-config.js";
    import { ref, push } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-database.js";

    const avatarGrid = document.getElementById('avatarGrid');
    const avatars = Array.from({length:10},(_,i)=>`https://gabrig07.github.io/amigo-secreto/imagens/avatar${i+1}.png`);
    let selected = null;
    avatars.forEach(src=>{
      const el = document.createElement('div');
      el.className = 'avatar-option';
      el.innerHTML = `<img src="${src}" alt="avatar">`;
      el.onclick = ()=>{
        document.querySelectorAll('.avatar-option').forEach(a=>a.classList.remove('selected'));
        el.classList.add('selected');
        selected = src;
      };
      avatarGrid.appendChild(el);
    });

    document.getElementById('btnCadastrar').addEventListener('click', async ()=>{
      const nome = document.getElementById('nome').value.trim();
      const senha = document.getElementById('senha').value.trim();
      if(!nome||!senha||!selected){alert('Preencha nome, senha e escolha um avatar');return}
      await push(ref(db,'participantes'),{nome,senha,avatar:selected});
      alert('Cadastro realizado');
      document.getElementById('nome').value='';
      document.getElementById('senha').value='';
      document.querySelectorAll('.avatar-option').forEach(a=>a.classList.remove('selected'));
    });
  </script>
</body>
</html>
